\import Algebra.Domain.Euclidean
\import Algebra.Group
\import Algebra.Meta
\import Algebra.Monoid
\import Algebra.Pointed
\import Algebra.Semiring
\import Algebra.Ring
\import Arith.Int
\import Arith.Rat
\import Meta
\import Paths

\lemma commRingTest {R : CRing} (a b c : R) : a * b - b * (a + c) + c * b * a = b * c * (a - 1)
  => equation.cRing

\lemma commRingTest2 {R : CRing} (a b : R) : (a + b) * (a - b) = a * a - b * b
  => equation.cRing

\lemma commRingArgTest {R : CRing} (a b : R) (p : 2 * (a * b) = 0) : (a + b) * (a + b) = a * a + b * b
  => equation.cRing p

\lemma commRingArgTest2 {R : CRing} (a : R) (p : negative a = 0) : 0 = a
  => equation.cRing p

\lemma commRingArgTest3 {R : CRing} (a b : R) (p : a * a - 2 * (a * b) = 0) : (a - b) * (a - b) = b * b
  => equation.cRing p

\lemma commRingForwardTest {R : CRing} (a b : R) (p : (a + b) * (a + b) = a * a + b * b) : 2 * (a * b) = 0
  => equation.cRing in p

\lemma commRingProofTest1 {R : CRing} (a b : R) (p : a * b = 0) : (a + b) * (a + b) = a * a + b * b
  => equation.cRing {p}

\lemma commRingProofTest2 {R : CRing} (a b : R) (p : b = negative b) : (a + b) * (a + b) = a * a + b * b
  => equation.cRing {R.toZero p}

\lemma commRingProofTest3 {R : CRing} (a b c : R) (p : a = b) : a * c = c * b
  => equation.cRing {p}

\lemma commRingProofTest4 {R : CRing} (a b c : R) (p : a = b) (q : b * c = 0) : a * c = 0
  => equation.cRing {p,q}

\lemma commRingProofTest5 {R : CRing} (q : 1 = {R} 0) : 2 = {R} 0
  => equation.cRing {q}

\lemma commRingProofTest6 {R : CRing} (a b : R) (p : a = b) : a * a + b * b = a * b + a * b
  => equation.cRing {p, R.toZero p}

\lemma commRingCoefTest {R : CRing} (a b c : R) (p : a = b) (q : negative a + (a * c + b) = 0) : a * c = 0
  => equation.cRing {1 p} q

\lemma commRingCoefTest2 {R : CRing} (a b c : R) (p : a = b) (q : a + (a * c - b) = 0) : a * c = 0
  => equation.cRing { -1 p } q

\lemma intTest1 {n m : Nat} : pos (n Nat.+ m) = pos (m Nat.+ n)
  => equation.cRing

\lemma intTest2 {n m : Nat} : pos n + (m Nat.- n) = pos m
  => equation.cRing

\lemma intTest3 {n : Nat} (p : pos n = 0) : 0 = neg n
  => equation.cRing p

-- TODO
-- \lemma ratTest {x : Rat} : ratio 1 2 * x + ratio 1 2 * x = x
--   => equation.cRing

\lemma commRingAutoTest {R : CRing} (a b c : R) : a * b - b * (a + c) + c * b * a = b * c * (a - 1)
  => equation.cRingAuto

\lemma commRingAxTest1 {R : CRing} (q : 0 = {R} 1) : 2 = {R} 0
  => equation.cRingAuto {q}

\lemma commRingAxTest2 {R : CRing} (a b : R) (p : a = b) : a * a + b * b = a * b + a * b
  => equation.cRingAuto {p}

\lemma commRingAxTest3 {R : CRing} (a b : R) (p : a = b) (q : a + b = ide) : a * a + b * b = a
  => equation.cRingAuto {p, q}

\lemma commRingTelescopicTest {R : CRing} (x0 x1 x2 x3 y : R) (p : x0 * y = 1)
                              (q1 : x1 = x0 * x0) (q2 : x2 = x1 * x1) (q3 : x3 = x2 * x2) (r : x3 = 0) : zro {R} = 1
  => equation.cRingAuto {p, q1, q2, q3, r}

\lemma intTestAuto {n m : Nat} : pos (n + m) = pos (m + n)
  => equation.cRingAuto