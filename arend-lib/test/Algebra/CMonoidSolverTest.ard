\import Algebra.Meta
\import Algebra.Monoid
\import Algebra.Pointed
\import Arith.Int
\import Order.Lattice \hiding (MeetSemilattice)
\import Meta
\import Paths

\lemma testComm1 {M : CMonoid} (x y z w : M)
  : (w * (ide * x)) * ((ide * y) * z) = x * ((y * (z * ide)) * w)
  => equation.cMonoid

\lemma testComm2 {M : CMonoid} (x y z w : M) (p : w * (x * (x * z)) = w * (x * (z * y)))
  : (w * (ide * x)) * ((ide * x) * z) = x * ((y * (z * ide)) * w)
  => equation.cMonoid p

\lemma testComm3 {M : CMonoid} (x y z w : M) (p : (w * (ide * x)) * ((ide * x) * z) = x * ((y * (z * ide)) * w))
  : w * (x * (x * z)) = w * (x * (z * y))
  => equation.cMonoid in p

\lemma testAb1 {M : AbMonoid} (x y z w : M)
  : (w + (zro + x)) + ((zro + y) + z) = x + ((y + (z + zro)) + w)
  => equation.abMonoid

\lemma testAb2 {M : AbMonoid} (x y z w : M) (p : w + (x + (x + z)) = w + (x + (z + y)))
  : (w + (zro + x)) + ((zro + x) + z) = x + ((y + (z + zro)) + w)
  => equation.abMonoid p

\lemma testAb3 {M : AbMonoid} (x y z w : M) (p : (w + (zro + x)) + ((zro + x) + z) = x + ((y + (z + zro)) + w))
  : w + (x + (x + z)) = w + (x + (z + y))
  => equation.abMonoid in p


\lemma testProofComm1 {M : CMonoid} (x y : M) (p : y * x = ide) : (y * x) * (y * x) = ide
  => equation.cMonoid {pmap (x * __ * y) p, p}

\lemma testProofComm2 {M : AbMonoid} (x y : M) (p : y + x = zro) : (y + x) + (y + x) = zro
  => equation.abMonoid {pmap (x + __ + y) p} p

\lemma testProofComm3 {M : CMonoid} (x y : M) (p : y * x = ide) : (y * x) * (y * x) = ide
  => equation.cMonoid {p,p}

\lemma testProofComm4 {M : AbMonoid} (x y : M) (p : y + x + y = zro) (q : x + x = y) : x + x + x + x + x = zro
  => equation.abMonoid {q,q,p}

\lemma testProofComm5 {M : CMonoid} (x y : M) (p : x = y) (q : y * y = x) : x * x * x * x * x = x
  => equation.cMonoid {5 p, 2 q, 2 p, q, 1 p, q}

\lemma testProofComm6 {M : AbMonoid} (x y z w : M) (p : x = y) (q : y + z = y + w) : x + z = x + w
  => equation.abMonoid {p,q}

\lemma testProofComm7 {M : CMonoid} (x y z : M) (p : x * x = y) (q : x * x * y = y) : x * x * y = x * x
  => equation.cMonoid { -1 p, q }

\lemma testProofComm8 {M : CMonoid} (x1 x2 y1 y2 z1 z2 : M) (p : x1 * y2 = y1 * x2) (q : y1 * z2 = z1 * y2)
  : x1 * z2 * y2 = z1 * x2 * y2
  => equation.cMonoid {p,q}

\lemma intTest1 {n m : Nat} : pos (n Nat.+ m) = pos (m Nat.+ n)
  => equation.abMonoid

\lemma intTest2 {n m k : Nat} : pos ((n Nat.+ m) Nat.+ k) = pos ((k Nat.+ m) Nat.+ n)
  => equation.abMonoid

-- old tests

\lemma testOneAx {M : CMonoid} (x y z : M) (p : x = y)
  : y * z = z * x
  => equation.cMonoidAuto {p}

\lemma testTwoAx {M : CMonoid} (x y : M) (p : x * y = ide) (q : y * y = x)
  : x * x = y
  => equation

\lemma testTwoAxRev {M : CMonoid} (x y : M) (p : y * x = 1) (q : x = y * y)
  : x * x = y
  => equation

\lemma testThreeAx {M : CMonoid} (x y z : M) (r : x * y = z) (p : x * z * x * x * z = y * z * y * y)
                   (q : x * z * x = y)
  : z * z = y * y * y * z
  => equation

\lemma idempTrivialTest {M : CMonoid} {a b : M} (a-idempotent : a * a = a) (a-inv : a * b = 1) : a = 1
  => equation

\open Bounded(MeetSemilattice,top)

\lemma test3 {L : MeetSemilattice} (x y z : L) : (x ∧ y) ∧ ((top ∧ x) ∧ z) = z ∧ ((y ∧ x) ∧ (z ∧ y))
  => equation
