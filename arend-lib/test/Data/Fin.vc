\open Combinators

\static \data Fin (n : Nat)
    | Fin (suc zero) => fzero
    | Fin (suc n) => fsuc (Fin n)

\static \function
to-nat {n : Nat} (x : Fin n) : Nat <= \elim n
    | suc n' <= \elim x
      | fsuc x' => suc $ to-nat x'
      | fzero => zero ;
    | zero <= \elim x

\static \function
to-nat-safe {n : Nat} (x : Fin (suc n)) : Nat <= \elim n
    | suc n' <= \elim x
      | fsuc x' => suc $ to-nat-safe x'
      | fzero <= zero ;
    | zero <= zero

\static \function
from-nat (n : Nat) : Fin (suc n) <= \elim n
    | suc n' => fsuc $ from-nat n'
    | zero => fzero

--\static \function
--inf-fin {n : Nat} (x : Fin n) : \Type0 <= Fin (to-nat x)
