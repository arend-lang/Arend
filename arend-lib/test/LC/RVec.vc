\open ::Paths
\open ::Data::Fin
\open ::Data::Empty

-- "развернутый" вектор, специально для наших нужд

\data RVec (n : Nat) (A : \Type)
    | RVec  zero   A => vnil
    | RVec (suc n) A => snoc (RVec n A) A

\function \infix 6
(!!) {n : Nat} {A : \Type} (xs : RVec n A) (i : Fin n) : A <= \elim n, xs, i
    | suc n, snoc xs x, fzero => x
    | suc n, snoc xs x, fsuc i => xs !! i

\function
rhead {n : Nat} {A : \Type} (xs : RVec (suc n) A) : A <= \elim xs
    | snoc xs x => x

\function
rtail {n : Nat} {A : \Type} (xs : RVec (suc n) A) : RVec n A <= \elim xs
    | snoc xs x => xs

\function
snoc-lemma {n : Nat} {A : \Type} (xs : RVec (suc n) A) : snoc (rtail xs) (rhead xs) = xs <= \elim xs
    | snoc xs x => idp
