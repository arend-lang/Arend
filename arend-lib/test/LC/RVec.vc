\open ::Data::Fin
\open ::Data::Empty

-- "развернутый" вектор, специально для наших нужд

\data RVec (n : Nat) (A : \Set0)
    | RVec  zero   A => vnil
    | RVec (suc n) A => snoc (RVec n A) A

\function \infix 6
(!) {n : Nat} {A : \Set0} (xs : RVec n A) (i : Fin n) : A <= \elim n, xs, i
    | suc n, snoc xs x, fzero => x
    | suc n, snoc xs x, fsuc i => xs ! i

\function
rhead {n : Nat} {A : \Set0} (xs : RVec (suc n) A) : A <= \elim xs
    | snoc xs x => x

\function
rtail {n : Nat} {A : \Set0} (xs : RVec (suc n) A) : RVec n A <= \elim xs
    | snoc xs x => xs
